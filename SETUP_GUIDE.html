<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>setup_guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SETUP_GUIDE_files/libs/clipboard/clipboard.min.js"></script>
<script src="SETUP_GUIDE_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="SETUP_GUIDE_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="SETUP_GUIDE_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="SETUP_GUIDE_files/libs/quarto-html/popper.min.js"></script>
<script src="SETUP_GUIDE_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SETUP_GUIDE_files/libs/quarto-html/anchor.min.js"></script>
<link href="SETUP_GUIDE_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SETUP_GUIDE_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SETUP_GUIDE_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SETUP_GUIDE_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SETUP_GUIDE_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">




<section id="captureexpert-setup-guide" class="level1">
<h1>CaptureExpert Setup Guide</h1>
<p>This guide walks through connecting all hardware devices and verifying they work before running an experiment.</p>
<hr>
<section id="hardware-required" class="level2">
<h2 class="anchored" data-anchor-id="hardware-required">Hardware Required</h2>
<ul>
<li><strong>2 USB Logitech webcams</strong> (any Logitech USB webcam that supports 1080p/30fps)</li>
<li><strong>2 GoPro Hero 7 Silver cameras</strong> with charged batteries and SD cards inserted</li>
<li><strong>2 USB WiFi adapters</strong> (one per GoPro, for wireless control)</li>
<li><strong>1 Polar H10 heart rate strap</strong> with chest band</li>
<li><strong>Mac computer</strong> with available USB ports and Bluetooth</li>
</ul>
<hr>
</section>
<section id="install-dependencies" class="level2">
<h2 class="anchored" data-anchor-id="install-dependencies">1. Install Dependencies</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install <span class="at">-r</span> requirements.txt</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This installs: <code>opencv-python</code>, <code>numpy</code>, <code>goprocam</code>, <code>bleak</code>, and <code>pytest</code>.</p>
<hr>
</section>
<section id="connect-the-usb-webcams" class="level2">
<h2 class="anchored" data-anchor-id="connect-the-usb-webcams">2. Connect the USB Webcams</h2>
<ol type="1">
<li>Plug both Logitech webcams into USB ports on your Mac.</li>
<li>The first webcam plugged in is typically assigned <strong>device index 0</strong>, the second <strong>device index 1</strong>. These indices are configured in <code>settings.json</code> under the <code>cameras</code> section.</li>
<li>To verify macOS recognises the cameras, open <strong>System Settings &gt; Privacy &amp; Security &gt; Camera</strong> and confirm your terminal app (Terminal, iTerm, etc.) has camera access.</li>
</ol>
<section id="finding-the-correct-device-indices" class="level3">
<h3 class="anchored" data-anchor-id="finding-the-correct-device-indices">Finding the correct device indices</h3>
<p>If you’re unsure which index maps to which webcam, you can test in Python:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Try index 0</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>cap <span class="op">=</span> cv2.VideoCapture(<span class="dv">0</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> cap.isOpened():</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    ret, frame <span class="op">=</span> cap.read()</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Index 0: </span><span class="sc">{</span>frame<span class="sc">.</span>shape <span class="cf">if</span> ret <span class="cf">else</span> <span class="st">'no frame'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    cap.release()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Try index 1</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>cap <span class="op">=</span> cv2.VideoCapture(<span class="dv">1</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> cap.isOpened():</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    ret, frame <span class="op">=</span> cap.read()</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Index 1: </span><span class="sc">{</span>frame<span class="sc">.</span>shape <span class="cf">if</span> ret <span class="cf">else</span> <span class="st">'no frame'</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    cap.release()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>If the indices don’t match the expected front/side positions, swap the <code>device_index</code> values in <code>settings.json</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="er">"cameras":</span> <span class="ot">[</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span> <span class="st">"usb_0"</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Logitech Webcam 1"</span><span class="fu">,</span> <span class="dt">"device_index"</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span> <span class="er">...</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span> <span class="st">"usb_1"</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Logitech Webcam 2"</span><span class="fu">,</span> <span class="dt">"device_index"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span> <span class="er">...</span><span class="fu">}</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
</section>
</section>
<section id="connect-the-gopro-cameras" class="level2">
<h2 class="anchored" data-anchor-id="connect-the-gopro-cameras">3. Connect the GoPro Cameras</h2>
<p>Each GoPro Hero 7 Silver is controlled over WiFi. Each camera needs its own dedicated USB WiFi adapter because each adapter connects to a different GoPro’s WiFi network.</p>
<section id="steps" class="level3">
<h3 class="anchored" data-anchor-id="steps">Steps</h3>
<ol type="1">
<li><p><strong>Turn on WiFi on each GoPro</strong>: On the Hero 7 Silver, swipe down on the touchscreen and tap <strong>Connections &gt; Wireless Connections &gt; On</strong>. Note each camera’s WiFi network name and password (shown on the camera screen).</p></li>
<li><p><strong>Plug in 2 USB WiFi adapters</strong>. macOS will assign them network interface names (e.g.&nbsp;<code>en1</code>, <code>en2</code>).</p></li>
<li><p><strong>Connect each WiFi adapter to a different GoPro’s WiFi network</strong>:</p>
<ul>
<li>Adapter on <code>en1</code> connects to GoPro #1’s WiFi</li>
<li>Adapter on <code>en2</code> connects to GoPro #2’s WiFi</li>
</ul>
<p>You can do this via <strong>System Settings &gt; Network</strong>, or from the command line:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">networksetup</span> <span class="at">-setairportnetwork</span> en1 <span class="st">"GP-Hero7-XXXX"</span> <span class="st">"password1"</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">networksetup</span> <span class="at">-setairportnetwork</span> en2 <span class="st">"GP-Hero7-YYYY"</span> <span class="st">"password2"</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div></li>
<li><p><strong>Verify the settings match</strong> in <code>settings.json</code>:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="er">"gopros":</span> <span class="ot">[</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span> <span class="st">"gopro_hero7_1"</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"GoPro Hero 7 Silver #1"</span><span class="fu">,</span> <span class="dt">"model"</span><span class="fu">:</span> <span class="st">"hero7_silver"</span><span class="fu">,</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>   <span class="dt">"wifi_interface"</span><span class="fu">:</span> <span class="st">"en1"</span><span class="fu">,</span> <span class="dt">"ip_address"</span><span class="fu">:</span> <span class="st">"10.5.5.9"</span><span class="fu">,</span> <span class="dt">"enabled"</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span><span class="dt">"id"</span><span class="fu">:</span> <span class="st">"gopro_hero7_2"</span><span class="fu">,</span> <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"GoPro Hero 7 Silver #2"</span><span class="fu">,</span> <span class="dt">"model"</span><span class="fu">:</span> <span class="st">"hero7_silver"</span><span class="fu">,</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>   <span class="dt">"wifi_interface"</span><span class="fu">:</span> <span class="st">"en2"</span><span class="fu">,</span> <span class="dt">"ip_address"</span><span class="fu">:</span> <span class="st">"10.5.5.9"</span><span class="fu">,</span> <span class="dt">"enabled"</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">}</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>All GoPros use the same IP address (<code>10.5.5.9</code>) but are accessed through different WiFi interfaces.</p></li>
</ol>
</section>
<section id="finding-your-wifi-interface-names" class="level3">
<h3 class="anchored" data-anchor-id="finding-your-wifi-interface-names">Finding your WiFi interface names</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">networksetup</span> <span class="at">-listallhardwareports</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Look for entries labelled “Wi-Fi” or “USB 10/100/1000 LAN” – the <code>Device</code> field (e.g.&nbsp;<code>en1</code>) is what goes in the <code>wifi_interface</code> setting.</p>
<hr>
</section>
</section>
<section id="connect-the-polar-h10-heart-rate-strap" class="level2">
<h2 class="anchored" data-anchor-id="connect-the-polar-h10-heart-rate-strap">4. Connect the Polar H10 Heart Rate Strap</h2>
<p>The Polar H10 connects over Bluetooth Low Energy (BLE). No pairing through macOS Bluetooth settings is needed – the <code>bleak</code> library handles the connection directly.</p>
<section id="steps-1" class="level3">
<h3 class="anchored" data-anchor-id="steps-1">Steps</h3>
<ol type="1">
<li><p><strong>Moisten the electrode pads</strong> on the inside of the chest strap and put it on. The strap must detect skin contact to broadcast a signal.</p></li>
<li><p><strong>Ensure Bluetooth is enabled</strong> on your Mac.</p></li>
<li><p>In <code>settings.json</code>, heart rate is already enabled:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="er">"heart_rate":</span> <span class="fu">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"enabled"</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"device_address"</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"ecg_enabled"</span><span class="fu">:</span> <span class="kw">false</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>With <code>device_address</code> set to <code>null</code>, the software will automatically scan for any nearby Polar H10. If you have multiple Polar H10 straps nearby and need to target a specific one, set <code>device_address</code> to its BLE MAC address (e.g.&nbsp;<code>"A0:9E:1A:XX:XX:XX"</code>).</p></li>
<li><p><strong>Grant Bluetooth access</strong>: macOS may prompt your terminal app for Bluetooth permission on first run. Accept this.</p></li>
</ol>
</section>
<section id="optional-enable-ecg" class="level3">
<h3 class="anchored" data-anchor-id="optional-enable-ecg">Optional: Enable ECG</h3>
<p>Set <code>"ecg_enabled": true</code> in <code>settings.json</code> to stream raw ECG data at 130 Hz alongside the standard heart rate. This produces an additional CSV file in the output. ECG requires the Polar H10 specifically (other Polar models do not support this feature).</p>
<hr>
</section>
</section>
<section id="verify-everything-with-calibration-mode" class="level2">
<h2 class="anchored" data-anchor-id="verify-everything-with-calibration-mode">5. Verify Everything with Calibration Mode</h2>
<p>Before running an experiment, use the built-in calibration check to confirm all devices are connected and working:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> main.py <span class="at">--calibrate</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>This will:</p>
<ol type="1">
<li><strong>Test each USB webcam</strong> – opens the device, captures a test frame, and reports the resolution</li>
<li><strong>Test each GoPro</strong> – connects over WiFi, reads battery level and model info</li>
<li><strong>Test the Polar H10</strong> – scans via BLE, connects, reads battery, and records 3 seconds of heart rate data to confirm signal</li>
</ol>
<p>You’ll see output like:</p>
<pre><code>============================================================
  CALIBRATION TOOL - Device Connectivity Check
============================================================

--- USB Cameras (2) ---
  Logitech Webcam 1: PASS - connected, frame captured (1920x1080)
  Logitech Webcam 2: PASS - connected, frame captured (1920x1080)

--- GoPro Cameras (2) ---
  GoPro Hero 7 Silver #1: PASS - connected, model=hero7_silver, battery=85%
  GoPro Hero 7 Silver #2: PASS - connected, model=hero7_silver, battery=72%

--- Polar H10 Heart Rate Monitor ---
  Polar H10: PASS - connected, battery=90%, HR signal detected

============================================================
  CALIBRATION SUMMARY
============================================================
  ...
  Results: 5/5 passed
  Overall: PASS - All devices ready
============================================================</code></pre>
<p>If any device shows <strong>FAIL</strong>, check:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Device</th>
<th>Common issues</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>USB webcam</td>
<td>Wrong device index, camera not plugged in, macOS camera permission denied</td>
</tr>
<tr class="even">
<td>GoPro</td>
<td>WiFi adapter not connected to GoPro’s network, GoPro powered off or asleep, wrong interface name in config</td>
</tr>
<tr class="odd">
<td>Polar H10</td>
<td>Strap not worn / electrodes dry, Bluetooth off, macOS Bluetooth permission denied, another app connected to the strap</td>
</tr>
</tbody>
</table>
<hr>
</section>
<section id="run-an-experiment" class="level2">
<h2 class="anchored" data-anchor-id="run-an-experiment">6. Run an Experiment</h2>
<p>Once calibration passes, run:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> main.py</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Or with a custom config file:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> main.py <span class="at">--config</span> my_settings.json</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The experiment runs through three phases:</p>
<ol type="1">
<li><strong>Calibration</strong> (10s) – GoPros connect, webcams capture frames, HR recording begins</li>
<li><strong>Recording</strong> (60s) – GoPros record video to SD cards, webcams capture at ~30fps, HR continues</li>
<li><strong>Post-Recording</strong> (indefinite) – GoPro battery status displayed, press <strong>Ctrl+C</strong> to finish</li>
</ol>
<p>On Ctrl+C or phase completion, the system saves all data and disconnects cleanly.</p>
<hr>
</section>
<section id="post-processing-gopro-lens-correction" class="level2">
<h2 class="anchored" data-anchor-id="post-processing-gopro-lens-correction">7. Post-Processing: GoPro Lens Correction</h2>
<p>GoPro footage is saved to the cameras’ SD cards. After downloading the video files, you can apply barrel distortion correction:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Process all .mp4 files in a directory</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> main.py <span class="at">--undistort</span> /path/to/gopro/videos/</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Process a single file</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> main.py <span class="at">--undistort</span> /path/to/clip.mp4</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Output files are saved alongside originals with an <code>_undistorted</code> suffix.</p>
<hr>
</section>
<section id="output-files" class="level2">
<h2 class="anchored" data-anchor-id="output-files">Output Files</h2>
<p>After an experiment, the <code>output/</code> directory contains:</p>
<pre><code>output/
  frames/
    calibration/
      usb_0_000001.jpg
      usb_1_000001.jpg
      ...
    recording/
      usb_0_000001.jpg
      ...
  heart_rate_YYYYMMDD_HHMMSS.csv
  ecg_YYYYMMDD_HHMMSS.csv          (only if ecg_enabled was true)</code></pre>
<ul>
<li><strong>Frame images</strong>: captured from the USB webcams during each phase</li>
<li><strong>heart_rate CSV</strong>: timestamp, BPM, RR intervals, sensor contact status, and phase label</li>
<li><strong>ECG CSV</strong>: timestamp, phase, and raw ECG microvolts (if enabled)</li>
</ul>
<p>GoPro video must be downloaded separately from the cameras’ SD cards.</p>
<hr>
</section>
<section id="troubleshooting" class="level2">
<h2 class="anchored" data-anchor-id="troubleshooting">Troubleshooting</h2>
<p><strong>Webcam shows black frames or wrong resolution</strong>: Some webcams need a moment to adjust exposure. The first few frames may be dark. If resolution doesn’t match, check the webcam supports 1920x1080 – lower the <code>resolution</code> in <code>settings.json</code> if needed (e.g.&nbsp;<code>[1280, 720]</code>).</p>
<p><strong>GoPro disconnects during experiment</strong>: GoPros drop WiFi if they don’t receive periodic keep-alive signals. The software sends these automatically every 2.5 seconds. If disconnects happen, check the WiFi adapter signal strength and move the adapters closer to the cameras.</p>
<p><strong>Polar H10 not found</strong>: Make sure the strap is on your body with moistened electrodes. The H10 only broadcasts a BLE signal when it detects skin contact. Also ensure no other app (e.g.&nbsp;Polar Beat, Polar Flow) is currently connected to the strap, as BLE only allows one connection.</p>
<p><strong>macOS permission prompts</strong>: The first time you run CaptureExpert, macOS may ask for Camera and Bluetooth access for your terminal. Grant both. If you accidentally denied, go to <strong>System Settings &gt; Privacy &amp; Security</strong> and add your terminal app manually.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>